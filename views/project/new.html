{{extend 'layout.html'}}
<div>
	<h2>New Project</h2>
	<progress max="3" value="{{=step}}"></progress>
	Step {{=step}} of 3.
	{{if step == 1:}}
		{{=form}}
	{{elif step == 2:}}
		<ul>
		{{for doc in new_project['documents']: }}
			<li>
			{{=doc['title']}}
			<img alt="{{=doc['title']}} image." 
			src="data:image/{{=doc['type']}};base64,{{=doc['image']}}">
			</li>
		{{pass}}
		</ul>
		{{=form}}
	{{else:}}
		<ul>
		{{for doc in new_project['documents']: }}
			<li>
			{{=doc['title']}}
			<img alt="{{=doc['title']}} image." 
			src="data:image/{{=doc['type']}};base64,{{=doc['image']}}">
			</li>
		{{pass}}
		</ul>
		<ul id="section-editor">
			<li>
			<a id="add-section">
			Add a new section.
			</a>
			</li>
		</ul>
		<form id="save=section" method='post'>
			<input type="hidden" name="_sections">
			<input type="submit" value="Save changes">
		</form>
	{{pass}}
</div>

{{block script}}
{{if step == 3:}}
	<script type="text/javascript" src="{{= URL('static', 'js/jquery.js') }}"></script>
	<script type="text/javascript">
		sections = [];

		$(document).ready(function() {
			$("#add-section").click(add_section);
		});

		function add_section() {
			$("#section-editor").append(
				$("<li></li>").html('<input name="section-title[1]" type="text">\
									<textarea></textarea>'));
		}
	</script>
{{pass}}
{{end}}